<div class="panel panel-info">
  <div class="panel-heading">
    <h3 class="panel-title"><%= @plan.title %></h3>
    <small><em> â€” an ERP plan designed by <%= @plan.user.name %></em></small>
    <br><br>
    <p><span class="glyphicon glyphicon-thumbs-up"></span> <strong>Goal</strong>: <%= @plan.goal %></p>
    <p><span class="glyphicon glyphicon-thumbs-up"></span> <strong>Treatment Approach</strong>: <%= treatment_approach(@plan) %></p>
    <br>
    <%= render partial: "plans/finish_plan_form", locals: { plan: @plan } if policy(@plan).create? %>
  </div>
  <div class="panel-body">
    <%= render :collection => @plan_steps, :partial => "steps/step_div", :as => :step %>
  </div>
</div>

<% if @plan.unfinished? && policy(@step).create? %>
  <div class="well well-lg">
    <h3>Add a New Step to "<%= @plan.title %>"</h3>
    <br>
    <%= render partial: "steps/step", locals: { plan: @plan, step: @step } %>
  </div>
<% end %>

<% if policy(@plan).edit? && @plan.unfinished? %>
  <br>
  <button class="btn btn-default btn-md">
    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
    <%= link_to "Edit Plan Overview", edit_plan_path(@plan) %>
  </button>
<% end %>

<% if policy(@plan).destroy? %>
  <button class="btn btn-default btn-md">
    <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
    <%= link_to "Delete ERP Plan", plan_path(@plan), method: :delete, data: { confirm: "Are you sure you want to delete this ERP plan?" } %>
  </button>
<% end %>
