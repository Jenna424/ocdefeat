<div class="report well well-lg">
  <h4>Progress Report</h4>
  <p>The report indicates that patient <%= planner(done, undone) %> <%= report(done, undone) %></p>
  <br>

  <% if done %> <!-- If the patient selected has finished ERP plans -->
    <p><strong><u>Finished Plans</u></strong></p>
    <%= present_plans(done) %>
  <% end %>

  <% if undone %> <!-- If the patient selected has unfinished ERP plans -->
    <p>
      <strong><u>Unfinished Plans:</u></strong>
      <% if undone.with_steps.empty? %>
        The patient must delineate the steps of every plan!
      <% elsif undone.stepless.empty? %>
        The patient must mark all steps as completed and then mark each plan as finished!
      <% end %>
    </p>

    <% if !undone.with_steps.empty? %>
      <p><em>~Delineated Plans:</em></p>

      <% if !undone.with_incomplete_step.empty? %>
        <p>Plans with at least one incomplete step:</p>
        <%= present_plans(undone.with_incomplete_step) %>
      <% end %>

      <% if !undone.unfinished_but_with_all_steps_completed.empty? %>
        <p>Plans with all steps marked complete but not yet submitted as finished:</p>
        <%= present_plans(undone.unfinished_but_with_all_steps_completed) %>
      <% end %>
    <% end %>

    <% if !undone.stepless.blank? %>
      <p><em>~Stepless Plans:</em></p>
      <%= present_plans(undone.stepless) %>
    <% end %>
  <% end %>
</div>
